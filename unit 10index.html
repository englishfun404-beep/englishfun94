<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>We Can 1 - Unit 10: Feelings & Things</title>
    <style>
        /* ============ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ============ */
        :root {
            --main-color: #8e44ad; /* Ø¨Ù†ÙØ³Ø¬ÙŠ */
            --accent-color: #9b59b6;
            --bg-color: #f4ecf7;
            --text-color: #2c3e50;
            --success: #27ae60;
            --error: #c0392b;
            --slot-bg: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            text-align: center;
            color: var(--text-color);
            user-select: none;
        }

        .container { max-width: 900px; margin: 0 auto; }

        /* Ø§Ù„Ø±Ø£Ø³ */
        .header {
            background-color: var(--main-color); color: white;
            padding: 25px; border-radius: 20px; margin-bottom: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-bottom: 5px solid #5b2c6f;
        }
        .header h1 { margin: 0; font-size: 2.5em; }
        
        .nav-container {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 30px;
        }
        .btn-nav {
            background: white; color: var(--main-color); border: 2px solid var(--main-color);
            padding: 12px 25px; border-radius: 30px; cursor: pointer;
            font-size: 1.1em; font-weight: bold; transition: 0.3s;
            box-shadow: 0 3px 5px rgba(0,0,0,0.05);
        }
        .btn-nav:hover, .btn-nav.active {
            background: var(--main-color); color: white; transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.15);
        }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section { display: none; animation: slideIn 0.4s; }
        .section.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        h2 { color: var(--dark); border-bottom: 3px solid var(--accent-color); display: inline-block; padding-bottom: 5px; margin-bottom: 25px; }
        h3 { color: var(--main-color); margin-top: 30px; margin-bottom: 15px; font-size: 1.8em; border-top: 2px dashed #ccc; padding-top: 20px; }

        /* ============ 1. Talk Time ============ */
        .chat-container { display: flex; flex-direction: column; gap: 20px; max-width: 600px; margin: 0 auto; }
        .chat-bubble { background: white; padding: 15px 25px; border-radius: 20px; position: relative; display: flex; align-items: center; gap: 15px; box-shadow: 0 3px 8px rgba(0,0,0,0.1); font-size: 1.2em; }
        .chat-left { align-self: flex-start; border-bottom-left-radius: 2px; background: #fff3e0; }
        .chat-right { align-self: flex-end; flex-direction: row-reverse; border-bottom-right-radius: 2px; background: #e3f2fd; }
        .character-icon { font-size: 2.5em; }
        .slot-inline { display: inline-flex; min-width: 100px; height: 45px; background-color: white; border: 2px dashed #8e44ad; border-radius: 10px; align-items: center; justify-content: center; margin: 0 5px; transition: 0.3s; vertical-align: middle; font-size: 0.9em; }
        .slot-inline.correct { background-color: #d5f5e3; border-color: var(--success); border-style: solid; }

        /* ============ 2. Feelings ============ */
        .feelings-grid { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .feeling-card { width: 140px; background: white; border-radius: 15px; padding: 15px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; }
        .feeling-icon { font-size: 4em; margin-bottom: 10px; }
        .feeling-slot { width: 100%; height: 45px; border: 2px dashed #ccc; border-radius: 8px; background: #fafafa; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.9em; }
        .feeling-slot.correct { background: #d5f5e3; border-color: green; }

        /* ============ 3. Clothes ============ */
        .clothes-grid { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .clothes-card { width: 150px; background: white; border-radius: 15px; padding: 15px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; border: 1px solid #eee; }
        .clothes-img { font-size: 3.5em; margin-bottom: 10px; display: flex; justify-content: center; align-items: center; height: 70px; }
        .svg-icon { width: 60px; height: 60px; }
        .clothes-slot { width: 100%; height: 40px; border: 2px dashed #ccc; border-radius: 8px; background: #fafafa; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.9em; }
        .clothes-slot.correct { background: #d5f5e3; border-color: green; }

        /* ============ 4. Grammar ============ */
        .grammar-grid { display: flex; flex-wrap: wrap; gap: 30px; justify-content: center; }
        .grammar-card { width: 240px; background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; text-align: center; font-size: 1.2em; }
        .grammar-img { font-size: 3em; margin: 10px 0; display: flex; align-items: center; gap: 10px; }
        .grammar-slot { width: 90px; height: 45px; border: 2px dashed #d35400; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; vertical-align: middle; margin-right: 5px;}
        .grammar-slot.correct { background: #d5f5e3; border-color: green; }

        /* ============ 5. Fun Time (Visual Scenes) ============ */
        .prep-container { display: flex; flex-wrap: wrap; gap: 30px; justify-content: center; max-width: 800px; margin: 0 auto; }
        .prep-card { background: white; border-radius: 15px; padding: 20px; width: 280px; box-shadow: 0 4px 10px rgba(0,0,0,0.08); text-align: left; direction: ltr; }
        
        /* Scenes */
        .scene-box {
            width: 100%; height: 120px; position: relative; margin-bottom: 15px;
            background-color: #fefefa; border-radius: 10px; border: 1px solid #eee;
            overflow: hidden; display: flex; justify-content: center; align-items: center;
        }
        .base-obj { font-size: 4.5em; z-index: 1; }
        .move-obj { font-size: 2.5em; position: absolute; z-index: 2; }
        
        /* Positioning for Effect */
        .move-obj.on-top { top: 10px; } /* Object ON something */
        .move-obj.inside { top: 40%; transform: scale(0.8); } /* Object IN something */
        
        /* Custom Desk for Computer */
        .base-table { 
            width: 100px; height: 10px; background: #795548; border-radius: 5px; position: relative; top: 30px; 
        }
        .base-table::before, .base-table::after { 
            content: ''; position: absolute; width: 10px; height: 50px; background: #795548; top: 10px; 
        }
        .base-table::before { left: 10px; } .base-table::after { right: 10px; }

        .prep-text { font-size: 1.2em; line-height: 2; }

        /* ============ 6. Phonics ============ */
        .phonics-grid { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .phonics-card { width: 140px; background: white; padding: 10px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; }
        .phonics-icon { font-size: 3.5em; margin-bottom: 5px; pointer-events: none; }
        .phonics-word { font-size: 1.4em; font-weight: bold; color: #555; margin-bottom: 10px; pointer-events: none; }
        
        .phonics-slot, .vowel-slot { 
            width: 100%; height: 45px; border: 2px dashed #ccc; border-radius: 8px; 
            background: #fafafa; display: flex; align-items: center; justify-content: center; 
            font-size: 1.1em; font-weight: bold;
        }
        .phonics-slot.correct, .vowel-slot.correct { background: #d5f5e3; border-color: green; }

        /* Quiz Style */
        .quiz-container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 20px; }
        .quiz-box { background: white; border: 2px solid #eee; border-radius: 15px; padding: 15px; width: 200px; display: flex; flex-direction: column; align-items: center; box-shadow: 0 3px 8px rgba(0,0,0,0.05); }
        .quiz-img { font-size: 3.5em; margin-bottom: 15px; height: 60px; display:flex; align-items:center;}
        .quiz-options { display: flex; gap: 10px; width: 100%; justify-content: center; }
        .q-btn { flex: 1; padding: 8px; font-size: 1.1em; border: 2px solid #ddd; background: #f9f9f9; border-radius: 8px; cursor: pointer; transition: 0.2s; font-weight: bold; color: #555; }
        .q-btn:hover { background: #e3f2fd; border-color: var(--main-color); }
        .feedback-mini { margin-top: 10px; font-weight: bold; min-height: 20px; font-size: 0.9em; }

        /* Sort Containers */
        .sort-container { display: flex; gap: 30px; justify-content: center; margin-top: 20px; }
        .sort-box { width: 40%; min-height: 250px; background: white; border: 3px solid #ccc; border-radius: 15px; padding: 15px; display: flex; flex-direction: column; align-items: center; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .sort-header { font-weight: bold; font-size: 1.4em; margin-bottom: 15px; border-bottom: 2px solid #eee; width: 100%; padding-bottom: 10px; color: var(--text-color); }
        .sb-short { border-color: #e67e22; background: #fef5e7; }
        .sb-long { border-color: #27ae60; background: #e8f8f5; }

        /* ============ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ ============ */
        .source-box { background: white; padding: 20px; border-radius: 15px; min-height: 80px; margin-top: 30px; border: 3px dashed #8e44ad; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; }
        .draggable { padding: 10px 20px; background-color: var(--main-color); color: white; border-radius: 25px; font-weight: bold; cursor: grab; font-size: 1.1em; box-shadow: 0 4px 0 #6c3483; transition: 0.1s; z-index: 100; pointer-events: auto !important; }
        .draggable:active { cursor: grabbing; transform: translateY(4px); box-shadow: none; }
        .draggable.locked { cursor: default; background-color: var(--success); box-shadow: none; transform: none; }
        
        .controls { margin-top: 30px; }
        .btn-reset { background: var(--text-color); color: white; border: none; padding: 10px 30px; border-radius: 10px; cursor: pointer; font-size: 1em; }

        /* Ù…Ø¤Ø´Ø± Ø¹Ø¯Ù… Ø§Ù„ØªÙØ§Ø¹Ù„ */
        .slot-inline *, .feeling-slot *, .clothes-slot *, .grammar-slot *, .phonics-slot *, .vowel-slot * { pointer-events: none; }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>We Can 1: Unit 10 (Feelings & Things) ğŸ˜Š</h1>
        <p>Interactive Activities</p>
    </div>

    <div class="nav-container">
        <button class="btn-nav active" onclick="showSection('talk-time')">ğŸ—£ï¸ Talk Time</button>
        <button class="btn-nav" onclick="showSection('feelings')">ğŸ˜Š Feelings</button>
        <button class="btn-nav" onclick="showSection('clothes')">ğŸ‘• Clothes</button>
        <button class="btn-nav" onclick="showSection('grammar')">ğŸ‘‰ These / Those</button>
        <button class="btn-nav" onclick="showSection('prep')">ğŸ“ In / On</button>
        <button class="btn-nav" onclick="showSection('phonics')">ğŸ”¤ Phonics</button>
    </div>

    <div id="talk-time" class="section active">
        <h2>Talk Time: What's the matter?</h2>
        <div class="chat-container">
            <div class="chat-bubble chat-left"><div class="character-icon">ğŸ‘©</div><div>Are you <div class="slot-inline" data-ans="happy" ondrop="drop(event)" ondragover="allowDrop(event)"></div>?</div></div>
            <div class="chat-bubble chat-right"><div class="character-icon">ğŸ‘¦</div><div>Yes, I <div class="slot-inline" data-ans="am" ondrop="drop(event)" ondragover="allowDrop(event)"></div>.</div></div>
            <div class="chat-bubble chat-left"><div class="character-icon">ğŸ‘©</div><div>What's the <div class="slot-inline" data-ans="matter" ondrop="drop(event)" ondragover="allowDrop(event)"></div>?</div></div>
            <div class="chat-bubble chat-right"><div class="character-icon">ğŸ‘¦</div><div>I'm <div class="slot-inline" data-ans="thirsty" ondrop="drop(event)" ondragover="allowDrop(event)"></div>.</div></div>
        </div>
        <div id="talk-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initTalkTime()">ğŸ”„ Reset</button></div>
    </div>

    <div id="feelings" class="section">
        <h2>Rhythms: How are you feeling?</h2>
        <div class="feelings-grid" id="feelings-grid-area"></div>
        <div id="feelings-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initFeelings()">ğŸ”„ Reset</button></div>
    </div>

    <div id="clothes" class="section">
        <h2>Words: Clothes Vocabulary</h2>
        <div class="clothes-grid" id="clothes-grid-area"></div>
        <div id="clothes-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initClothes()">ğŸ”„ Reset</button></div>
    </div>

    <div id="grammar" class="section">
        <h2>Grammar: Demonstratives</h2>
        <div class="grammar-grid">
            <div class="grammar-card"><div class="grammar-img">ğŸ‘“ğŸ‘‡</div><div class="grammar-slot" data-ans="These" ondrop="drop(event)" ondragover="allowDrop(event)"></div> are glasses.</div>
            <div class="grammar-card"><div class="grammar-img">ğŸ‘‰ğŸ§¢ğŸ§¢</div><div class="grammar-slot" data-ans="Those" ondrop="drop(event)" ondragover="allowDrop(event)"></div> are caps.</div>
            <div class="grammar-card"><div class="grammar-img">ğŸ‘ğŸ‘ğŸ‘‡</div><div class="grammar-slot" data-ans="These" ondrop="drop(event)" ondragover="allowDrop(event)"></div> are shoes.</div>
            <div class="grammar-card"><div class="grammar-img">ğŸ‘‰ğŸ‘•ğŸ‘•</div><div class="grammar-slot" data-ans="Those" ondrop="drop(event)" ondragover="allowDrop(event)"></div> are T-shirts.</div>
        </div>
        <div id="grammar-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initGrammar()">ğŸ”„ Reset</button></div>
    </div>

    <div id="prep" class="section">
        <h2>Fun Time: Where is it? (in / on)</h2>
        <div class="prep-container">
            <div class="prep-card">
                <div class="scene-box"><div class="base-obj">ğŸ“¦</div><div class="move-obj inside">ğŸ’</div></div>
                <div class="prep-text">The ring is <div class="slot-inline" data-ans="in" ondrop="drop(event)" ondragover="allowDrop(event)"></div> the box.</div>
            </div>
            <div class="prep-card">
                <div class="scene-box"><div class="base-table"></div><div class="move-obj on-top">ğŸ’»</div></div>
                <div class="prep-text">The computer is <div class="slot-inline" data-ans="on" ondrop="drop(event)" ondragover="allowDrop(event)"></div> the desk.</div>
            </div>
            <div class="prep-card">
                <div class="scene-box"><div class="base-obj">ğŸ›ï¸</div><div class="move-obj on-top">ğŸ§¦</div></div>
                <div class="prep-text">The sock is <div class="slot-inline" data-ans="on" ondrop="drop(event)" ondragover="allowDrop(event)"></div> the bed.</div>
            </div>
            <div class="prep-card">
                <div class="scene-box"><div class="base-obj">ğŸ’</div><div class="move-obj inside" style="font-size:1.8em;">âœï¸</div></div>
                <div class="prep-text">The pencil is <div class="slot-inline" data-ans="in" ondrop="drop(event)" ondragover="allowDrop(event)"></div> the bag.</div>
            </div>
        </div>
        <div id="prep-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initPrep()">ğŸ”„ Reset</button></div>
    </div>

    <div id="phonics" class="section">
        <h2>Phonics Practice</h2>
        
        <h3>1. Complete the words (Drag & Drop)</h3>
        <div class="phonics-grid" id="phonics-grid-area"></div>
        <div id="phonics-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>

        <hr style="margin: 40px 0; border-top: 3px solid #eee;">

        <h3>2. Listen and check (Quiz)</h3>
        <div class="quiz-container" id="phonics-quiz-area"></div>

        <hr style="margin: 40px 0; border-top: 3px solid #eee;">

        <h3>3. Match Word to Picture</h3>
        <div class="phonics-grid" id="vowels-grid-area"></div>
        <div id="vowels-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>

        <hr style="margin: 40px 0; border-top: 3px solid #eee;">

        <h3>4. Sort: Short vs Long Vowels</h3>
        <div class="sort-container">
            <div class="sort-box sb-short" id="box-short" ondrop="dropSort(event, 'short')" ondragover="allowDrop(event)">
                <div class="sort-header">Short Vowel (e.g. sit)</div>
            </div>
            <div class="sort-box sb-long" id="box-long" ondrop="dropSort(event, 'long')" ondragover="allowDrop(event)">
                <div class="sort-header">Long Vowel (e.g. sea)</div>
            </div>
        </div>
        <div id="sort-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        
        <div class="controls"><button class="btn-reset" onclick="initPhonics()">ğŸ”„ Reset All Phonics</button></div>
    </div>

</div>

<script>
    // ============ AUDIO SYSTEM ============
    const synth = window.speechSynthesis;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function speak(text) { if(synth.speaking) synth.cancel(); let u = new SpeechSynthesisUtterance(text); u.lang='en-US'; synth.speak(u); }
    function playSound(isCorrect) {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        let osc = audioCtx.createOscillator(), gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        if(isCorrect){ osc.type='sine'; osc.frequency.setValueAtTime(600,0); osc.frequency.exponentialRampToValueAtTime(1000,0.1); gain.gain.setValueAtTime(0.1,0); gain.gain.exponentialRampToValueAtTime(0.01,0.3); osc.start(); osc.stop(0.3); }
        else { osc.type='sawtooth'; osc.frequency.setValueAtTime(150,0); gain.gain.setValueAtTime(0.1,0); gain.gain.linearRampToValueAtTime(0.01,0.2); osc.start(); osc.stop(0.2); }
    }

    // ============ DATA ============
    const talkData = ["happy", "am", "matter", "thirsty"];
    const feelingsData = [{w: "Happy", i: "ğŸ˜Š"}, {w: "Sad", i: "ğŸ˜¢"}, {w: "Hungry", i: "ğŸ˜‹"}, {w: "Thirsty", i: "ğŸ¥¤"}, {w: "Angry", i: "ğŸ˜¡"}, {w: "Scared", i: "ğŸ˜±"}, {w: "Sleepy", i: "ğŸ˜´"}, {w: "Bored", i: "ğŸ˜‘"}];
    const clothesData = [{w: "Skirt", svg: '<svg width="60" height="60" viewBox="0 0 100 100"><path d="M25,30 L75,30 L85,90 L15,90 Z" fill="#E91E63" stroke="#C2185B" stroke-width="2"/></svg>'}, {w: "T-shirt", i: "ğŸ‘•"}, {w: "Trousers", i: "ğŸ‘–"}, {w: "Cap", i: "ğŸ§¢"}, {w: "Glasses", i: "ğŸ‘“"}, {w: "Shoes", i: "ğŸ‘"}];
    const grammarData = ["These", "Those", "These", "Those"];
    const prepData = ["in", "on", "on", "in"];

    // Phonics Part 1: Complete Words
    const phonicsDragData = [
        {l:"sh", w:"__ip", i:"ğŸš¢"}, {l:"ch", w:"__eese", i:"ğŸ§€"},
        {l:"th", w:"__ree", i:"3ï¸âƒ£"}, {l:"b", w:"__ear", i:"ğŸ»"},
        {l:"p", w:"__ear", i:"ğŸ"}, {l:"f", w:"__an", i:"ğŸ’¨"},
        {l:"v", w:"__an", i:"ğŸš"}
    ];

    // Phonics Part 2: Quiz
    const phonicsQuizData = [
        { w: "tap", i: "ğŸš°", a: "tap", opts: ["tap", "cap", "tape"] },
        { w: "van", i: "ğŸš", a: "van", opts: ["van", "vase", "save"] },
        { w: "rice", i: "ğŸš", a: "rice", opts: ["rice", "ring", "nice"] },
        { w: "pin", i: "ğŸ“", a: "pin", opts: ["pin", "pine", "nine"] },
        { w: "tube", i: "ğŸ§´", a: "tube", opts: ["tube", "tub", "cube"] },Â 
        { w: "cut", i: "âœ‚ï¸", a: "cut", opts: ["cut", "cute", "cat"] },
        { w: "rose", i: "ğŸŒ¹", a: "rose", opts: ["rope", "rice", "rose"] }
    ];

    // Phonics Part 3: Match Word (8 Words)
    const vowelsData = [
        {w: "tap", i: "ğŸš°"}, {w: "tape", i: "ğŸ“¼"},
        {w: "pin", i: "ğŸ“"}, {w: "pine", i: "ğŸŒ²"},
        {w: "top", i: "ğŸŒªï¸"}, {w: "rope", i: "â°"},
        {w: "cub", i: "ğŸ¦"}, {w: "cube", i: "ğŸ§Š"}Â 
    ];

    // Phonics Part 4: Sort Short vs Long (NEW)
    const longShortData = [
        {w: "ship", t: "short"}, {w: "sit", t: "short"},
        {w: "sheep", t: "long"}, {w: "sea", t: "long"},
        {w: "speak", t: "long"}, {w: "week", t: "long"}
    ];

    // ============ INITIALIZATION ============
    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.btn-nav').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        const btns = document.querySelectorAll('.btn-nav');
        if(id==='talk-time') { btns[0].classList.add('active'); initTalkTime(); }
        if(id==='feelings') { btns[1].classList.add('active'); initFeelings(); }
        if(id==='clothes') { btns[2].classList.add('active'); initClothes(); }
        if(id==='grammar') { btns[3].classList.add('active'); initGrammar(); }
        if(id==='prep') { btns[4].classList.add('active'); initPrep(); }
        if(id==='phonics') { btns[5].classList.add('active'); initPhonics(); }
    }

    function initTalkTime() { const s=document.getElementById('talk-source'); s.innerHTML=''; document.querySelectorAll('#talk-time .slot-inline').forEach(x=>{x.innerHTML='';x.classList.remove('correct')}); [...talkData].sort(()=>Math.random()-0.5).forEach(w=>createDraggable(w,s)); }
    function initFeelings() { const g=document.getElementById('feelings-grid-area'), s=document.getElementById('feelings-source'); g.innerHTML=''; s.innerHTML=''; feelingsData.forEach(x=>{g.innerHTML+=`<div class="feeling-card"><div class="feeling-icon">${x.i}</div><div class="feeling-slot" data-ans="${x.w}" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>`;}); [...feelingsData].sort(()=>Math.random()-0.5).forEach(x=>createDraggable(x.w,s)); }
    function initClothes() { const g=document.getElementById('clothes-grid-area'), s=document.getElementById('clothes-source'); g.innerHTML=''; s.innerHTML=''; clothesData.forEach(x=>{g.innerHTML+=`<div class="clothes-card"><div class="clothes-img">${x.svg||x.i}</div><div class="clothes-slot" data-ans="${x.w}" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>`;}); [...clothesData].sort(()=>Math.random()-0.5).forEach(x=>createDraggable(x.w,s)); }
    function initGrammar() { const s=document.getElementById('grammar-source'); s.innerHTML=''; document.querySelectorAll('#grammar .grammar-slot').forEach(x=>{x.innerHTML='';x.classList.remove('correct')}); [...grammarData].sort(()=>Math.random()-0.5).forEach(w=>createDraggable(w,s)); }
    function initPrep() { const s=document.getElementById('prep-source'); s.innerHTML=''; document.querySelectorAll('#prep .slot-inline').forEach(x=>{x.innerHTML='';x.classList.remove('correct')}); [...prepData].sort(()=>Math.random()-0.5).forEach(w=>createDraggable(w,s)); }
    
    function initPhonics() {
        // Part 1: Complete Words
        const pg=document.getElementById('phonics-grid-area'), ps=document.getElementById('phonics-source'); pg.innerHTML=''; ps.innerHTML='';
        phonicsDragData.forEach(x=>{pg.innerHTML+=`<div class="phonics-card"><div class="phonics-icon">${x.i}</div><div class="phonics-word">${x.w}</div><div class="phonics-slot" data-ans="${x.l}" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>`;});
        [...phonicsDragData].map(x=>x.l).sort(()=>Math.random()-0.5).forEach(l=>createDraggable(l,ps));

        // Part 2: Quiz
        const qa = document.getElementById('phonics-quiz-area'); qa.innerHTML = '';
        phonicsQuizData.forEach((item, idx) => {
            let shuffledOpts = [...item.opts].sort(() => Math.random() - 0.5);
            let btnsHTML = shuffledOpts.map(o => `<button class="q-btn" onclick="checkQuiz(this, '${o}', '${item.a}')">${o}</button>`).join('');
            qa.innerHTML += `<div class="quiz-box"><div class="quiz-img">${item.i}</div><div class="quiz-options">${btnsHTML}</div><div class="feedback-mini"></div></div>`;
        });

        // Part 3: Match Word
        const vg = document.getElementById('vowels-grid-area'), vs = document.getElementById('vowels-source');
        vg.innerHTML = ''; vs.innerHTML = '';
        vowelsData.forEach(x => {
            vg.innerHTML += `<div class="phonics-card"><div class="phonics-icon">${x.i}</div><div class="phonics-slot vowel-slot" data-ans="${x.w}" ondrop="drop(event)" ondragover="allowDrop(event)"></div></div>`;
        });
        [...vowelsData].sort(()=>Math.random()-0.5).forEach(x => createDraggable(x.w, vs));

        // Part 4: Sort Long/Short (NEW)
        const ss = document.getElementById('sort-source'); ss.innerHTML = '';
        // Clear existing items in boxes
        document.querySelectorAll('.sort-box .draggable').forEach(e => e.remove());
        longShortData.sort(()=>Math.random()-0.5).forEach(i => {
            let d = createDraggable(i.w, ss); d.dataset.type = i.t;
        });
    }

    function checkQuiz(btn, val, cor) {
        let p = btn.parentElement;
        let fb = p.nextElementSibling;
        Array.from(p.children).forEach(b => { b.style.background='#f9f9f9'; b.style.color='#555'; });
        if (val === cor) {
            btn.style.background = '#d4edda'; btn.style.color = 'green';
            fb.innerText = 'âœ… Correct!'; fb.style.color = 'green';
            playSound(true); speak(cor);
        } else {
            btn.style.background = '#f8d7da'; btn.style.color = 'red';
            fb.innerText = 'âŒ Try Again'; fb.style.color = 'red';
            playSound(false);
        }
    }

    // Logic
    function createDraggable(text, container) {
        let d=document.createElement('div'); d.className='draggable'; d.draggable=true; d.innerText=text; d.id='d-'+Math.random();
        d.ondragstart=(e)=>{e.dataTransfer.setData("text",e.target.id); speak(text);}; d.onclick=()=>speak(text); container.appendChild(d);
        return d;
    }
    function allowDrop(e) { e.preventDefault(); }
    function drop(e) {
        e.preventDefault(); let d=e.dataTransfer.getData("text"), i=document.getElementById(d), t=e.target;
        if(!t.classList.contains('slot-inline')&&!t.classList.contains('feeling-slot')&&!t.classList.contains('clothes-slot')&&!t.classList.contains('grammar-slot')&&!t.classList.contains('phonics-slot')&&!t.classList.contains('vowel-slot')) t=t.closest('.slot-inline')||t.closest('.feeling-slot')||t.closest('.clothes-slot')||t.closest('.grammar-slot')||t.closest('.phonics-slot')||t.closest('.vowel-slot');
        if(t&&i){ if(t.children.length>0)return; if(i.innerText===t.dataset.ans){t.appendChild(i); t.classList.add('correct'); i.draggable=false; i.classList.add('locked'); playSound(true); speak("Correct!");} else playSound(false); }
    }
    function dropSort(e, type) {
        e.preventDefault(); let d=e.dataTransfer.getData("text"), i=document.getElementById(d);
        // Ensure dropping on correct box
        let target = e.target.closest('.sort-box');
        if(i && target && i.dataset.type===type) {
             target.appendChild(i); i.draggable=false; i.classList.add('locked'); playSound(true); speak("Correct!");
        } else playSound(false);
    }
    function returnItem(e) { e.preventDefault(); let d=e.dataTransfer.getData("text"), i=document.getElementById(d); if(e.target.classList.contains('source-box')) e.target.appendChild(i); }

    initTalkTime();

</script>

</body>
</html>