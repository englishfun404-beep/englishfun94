<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>We Can 1 - Unit 1: My Friends</title>
    <style>
        /* ============ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ============ */
        :root {
            --primary: #3498db; /* Ø£Ø²Ø±Ù‚ */
            --secondary: #f1c40f; /* Ø£ØµÙØ± */
            --accent: #e74c3c; /* Ø£Ø­Ù…Ø± */
            --dark: #2c3e50;
            --light: #ecf0f1;
            --success: #2ecc71;
            --intro: #9b59b6; /* Ù„ÙˆÙ† Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #e0f7fa;
            margin: 0;
            padding: 20px;
            text-align: center;
            color: var(--dark);
            user-select: none;
        }

        .container { max-width: 950px; margin: 0 auto; }

        /* ============ Ø§Ù„Ø±Ø£Ø³ ÙˆØ§Ù„Ù‚Ø§Ø¦Ù…Ø© ============ */
        .header {
            background-color: var(--primary); color: white;
            padding: 25px; border-radius: 20px; margin-bottom: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-bottom: 5px solid #2980b9;
        }
        .header h1 { margin: 0; font-size: 2.5em; }
        
        .nav-container {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 30px;
        }
        .btn-nav {
            background: white; color: var(--primary); border: 2px solid var(--primary);
            padding: 12px 25px; border-radius: 30px; cursor: pointer;
            font-size: 1.1em; font-weight: bold; transition: 0.3s;
            box-shadow: 0 3px 5px rgba(0,0,0,0.05);
        }
        .btn-nav:hover, .btn-nav.active {
            background: var(--primary); color: white; transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.15);
        }
        
        .btn-intro { border-color: var(--intro); color: var(--intro); }
        .btn-intro:hover, .btn-intro.active { background: var(--intro); color: white; }

        /* ============ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (Ø§Ù„ØºØ±Ù) ============ */
        .section { display: none; animation: slideIn 0.4s; }
        .section.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        h2 { color: var(--dark); border-bottom: 3px solid var(--secondary); display: inline-block; padding-bottom: 5px; margin-bottom: 25px; }

        /* ============ Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ============ */
        .pic-grid { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .pic-card {
            background: white; border: 2px solid #eee; border-radius: 15px; padding: 10px;
            width: 180px; display: flex; flex-direction: column; align-items: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05); position: relative;
        }
        .pic-scene { 
            height: 110px; width: 100%; 
            background: #f0f4c3; border-radius: 10px; margin-bottom: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 3.5em; line-height: 1; position: relative;
            overflow: hidden;
        }
        .bg-blue { background: #e3f2fd; } .bg-green { background: #e8f5e9; } 
        .bg-red { background: #ffebee; } .bg-yellow { background: #fffde7; }

        .pic-slot { 
            width: 100%; height: 50px; border: 2px dashed #ccc; border-radius: 8px; 
            background: #f9f9f9; display: flex; align-items: center; justify-content: center; position: relative;
            font-size: 0.85em; text-align: center; padding: 2px;
        }
        .pic-slot.correct { background-color: #c8e6c9; border-color: green; }

        /* ============ Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª (Greetings) ============ */
        .chat-container {
            display: flex; flex-direction: column; gap: 20px; max-width: 600px; margin: 0 auto;
        }
        .chat-bubble {
            background: white; padding: 15px 25px; border-radius: 20px;
            position: relative; display: flex; align-items: center; gap: 15px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1); font-size: 1.2em;
        }
        .chat-left { align-self: flex-start; border-bottom-left-radius: 2px; background: #fff3e0; }
        .chat-right { align-self: flex-end; flex-direction: row-reverse; border-bottom-right-radius: 2px; background: #e3f2fd; }
        .character-icon { font-size: 2em; }

        .slot-inline {
            display: inline-flex; min-width: 120px; height: 45px;
            background-color: white; border: 2px dashed #bdc3c7; border-radius: 10px;
            align-items: center; justify-content: center; margin: 0 5px;
            transition: 0.3s; vertical-align: middle;
        }
        .slot-inline.correct { background-color: #d5f5e3; border-color: var(--success); border-style: solid; }

        /* ============ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Colors) ============ */
        .colors-grid { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .color-card {
            width: 140px; height: 160px; background: white; border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); display: flex; flex-direction: column;
            overflow: hidden; transition: 0.3s;
        }
        .color-display { flex-grow: 1; border-bottom: 2px dashed #eee; }
        .color-slot { height: 50px; display: flex; align-items: center; justify-content: center; background: #fafafa; }
        .color-slot.correct { background: #d5f5e3; }

        /* ============ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø±ÙˆÙ (Phonics) ============ */
        .phonics-row { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 20px; }

        /* ============ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ ============ */
        .source-box {
            background: white; padding: 20px; border-radius: 15px; min-height: 80px;
            margin-top: 30px; border: 3px dashed #bdc3c7;
            display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;
        }

        .draggable {
            padding: 8px 15px; background-color: var(--accent); color: white;
            border-radius: 10px; font-weight: bold; cursor: grab; font-size: 1em;
            box-shadow: 0 4px 0 #c0392b; transition: 0.1s; z-index: 100;
        }
        .draggable:active { cursor: grabbing; transform: translateY(4px); box-shadow: none; }
        .draggable.locked { cursor: default; background-color: var(--success); box-shadow: none; transform: none; }

        /* ============ ØªØ­ÙƒÙ… ÙˆØ£Ø²Ø±Ø§Ø± ============ */
        .controls { margin-top: 30px; }
        .btn-reset {
            background: var(--dark); color: white; border: none; padding: 10px 30px;
            border-radius: 10px; cursor: pointer; font-size: 1em;
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¨Ø§Ø²Ù„ */
        .puzzle-icon {
            position: absolute; right: -8px; top: -8px; font-size: 1.1em;
            background: white; border-radius: 50%; padding: 2px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); pointer-events: none;
        }

        /* Ù…Ø¤Ø´Ø± Ø¹Ø¯Ù… Ø§Ù„ØªÙØ§Ø¹Ù„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³Ù„ÙˆØª */
        .slot-inline *, .color-slot *, .pic-slot * { pointer-events: none; }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>We Can 1: My Friends ğŸ¤</h1>
        <p>Unit 1 Interactive Activities</p>
    </div>

    <div class="nav-container">
        <button class="btn-nav btn-intro active" onclick="showSection('intro')">ğŸš€ Introduction</button>
        <button class="btn-nav" onclick="showSection('talk-time')">ğŸ—£ï¸ Greetings</button>
        <button class="btn-nav" onclick="showSection('colors')">ğŸ¨ Colors</button>
        <button class="btn-nav" onclick="showSection('phonics')">ğŸ”¤ Phonics</button>
    </div>

    <div id="intro" class="section active">
        <h2>Introduction: Classroom Commands</h2>
        <p>Match the command to the picture.</p>
        
        <div class="pic-grid" id="intro-grid-area"></div>

        <div style="text-align:center; margin-top:20px; font-weight:bold;">Commands:</div>
        <div id="intro-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initIntro()">ğŸ”„ Reset</button></div>
    </div>

    <div id="talk-time" class="section">
        <h2>Talk Time: Greetings</h2>
        <p>Complete the conversation.</p>

        <div class="chat-container">
            <div class="chat-bubble chat-left">
                <div class="character-icon">ğŸ‘¦</div>
                <div>Hello.</div>
            </div>
            <div class="chat-bubble chat-right">
                <div class="character-icon">ğŸ¤–</div>
                <div class="slot-inline" data-ans="Hi" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            </div>
            
            <div class="chat-bubble chat-left">
                <div class="character-icon">ğŸ‘¦</div>
                <div>What's your name?</div>
            </div>
            <div class="chat-bubble chat-right">
                <div class="character-icon">ğŸ¤–</div>
                <div><div class="slot-inline" data-ans="My name's" ondrop="drop(event)" ondragover="allowDrop(event)"></div> Labeeb.</div>
            </div>

            <div class="chat-bubble chat-left">
                <div class="character-icon">ğŸ‘¦</div>
                <div>How are you?</div>
            </div>
            <div class="chat-bubble chat-right">
                <div class="character-icon">ğŸ¤–</div>
                <div>I'm <div class="slot-inline" data-ans="fine" ondrop="drop(event)" ondragover="allowDrop(event)"></div>, thank you.</div>
            </div>

             <div class="chat-bubble chat-left">
                <div class="character-icon">ğŸ‘¦</div>
                <div>Good-bye!</div>
            </div>
            <div class="chat-bubble chat-right">
                <div class="character-icon">ğŸ¤–</div>
                <div class="slot-inline" data-ans="See you" ondrop="drop(event)" ondragover="allowDrop(event)"></div> again.
            </div>
        </div>

        <div id="talk-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initTalkTime()">ğŸ”„ Reset</button></div>
    </div>

    <div id="colors" class="section">
        <h2>Words: Colors ğŸŒˆ</h2>
        <p>Match the words to the colors.</p>
        
        <div class="colors-grid" id="colors-grid-area"></div>
        <div id="colors-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initColors()">ğŸ”„ Reset</button></div>
    </div>

    <div id="phonics" class="section">
        <h2>Phonics: The Alphabet ğŸ”¤</h2>
        <p>Put the letters in the correct order (A - G).</p>
        <div class="phonics-row" id="phonics-grid">
             </div>
        <div id="phonics-source" class="source-box" ondrop="returnItem(event)" ondragover="allowDrop(event)"></div>
        <div class="controls"><button class="btn-reset" onclick="initPhonics()">ğŸ”„ Reset</button></div>
    </div>

</div>

<script>
    // ============ AUDIO SYSTEM ============
    const synth = window.speechSynthesis;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function speak(text) {
        if (synth.speaking) synth.cancel();
        let u = new SpeechSynthesisUtterance(text);
        u.lang = 'en-US';
        synth.speak(u);
    }

    function playSound(isCorrect) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        let osc = audioCtx.createOscillator();
        let gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        if (isCorrect) {
            osc.type = 'sine'; osc.frequency.setValueAtTime(600, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.3);
        } else {
            osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime); osc.start(); osc.stop(audioCtx.currentTime + 0.2);
        }
    }

    // ============ DATA ============
    
    // 0. Introduction Data (9 Items)
    const introData = [
        {w:"Welcome!", i:"ğŸ‘‹", bg:"bg-green"},
        {w:"Put your bags away.", i:"ğŸ’", bg:"bg-blue"},
        {w:"Take out your pencils.", i:"âœï¸", bg:"bg-yellow"},
        {w:"Take out your books.", i:"ğŸ“š", bg:"bg-red"},
        {w:"Please take a seat.", i:"ğŸª‘", bg:"bg-blue"},
        {w:"Please open the window.", i:"ğŸªŸ", bg:"bg-green"},
        {w:"Okay.", i:"ğŸ‘Œ", bg:"bg-yellow"},
        {w:"Thank you.", i:"ğŸ™", bg:"bg-red"},
        {w:"You're welcome.", i:"ğŸ¤", bg:"bg-blue"}
    ];

    // 1. Talk Time Data
    const talkData = ["Hi", "My name's", "fine", "See you"];
    
    // 2. Colors Data
    const colorsData = [
        {w: "Red", c: "#e74c3c"}, {w: "Blue", c: "#3498db"}, 
        {w: "Green", c: "#2ecc71"}, {w: "Yellow", c: "#f1c40f"},
        {w: "Orange", c: "#e67e22"}, {w: "Purple", c: "#9b59b6"},
        {w: "Pink", c: "#e91e63"}, {w: "White", c: "#ffffff"},
        {w: "Black", c: "#2c3e50"}, {w: "Brown", c: "#795548"}
    ];

    // 3. Phonics Data
    const phonicsData = ["A", "B", "C", "D", "E", "F", "G"];

    // ============ INITIALIZATION ============
    
    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.btn-nav').forEach(b => b.classList.remove('active'));
        
        document.getElementById(id).classList.add('active');
        
        if(id === 'intro') { 
            document.querySelector('.btn-intro').classList.add('active');
            initIntro();
        }
        if(id === 'talk-time') initTalkTime();
        if(id === 'colors') initColors();
        if(id === 'phonics') initPhonics();
    }

    // --- Introduction ---
    function initIntro() {
        const grid = document.getElementById('intro-grid-area');
        const src = document.getElementById('intro-source');
        grid.innerHTML = ''; src.innerHTML = '';
        
        introData.forEach(x => {
            let card = document.createElement('div');
            card.className = 'pic-card';
            card.innerHTML = `
                <div class="pic-scene ${x.bg}">${x.i}</div>
                <div class="pic-slot" data-ans="${x.w}" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <span class="puzzle-icon">ğŸ§©</span>
                </div>`;
            grid.appendChild(card);
        });
        
        [...introData].sort(()=>Math.random()-0.5).forEach(x => createDraggable(x.w, src));
    }

    // --- Talk Time ---
    function initTalkTime() {
        const src = document.getElementById('talk-source');
        src.innerHTML = '';
        document.querySelectorAll('#talk-time .slot-inline').forEach(s => {
            s.innerHTML = ''; s.classList.remove('correct', 'wrong');
        });
        [...talkData].sort(() => Math.random() - 0.5).forEach(word => createDraggable(word, src));
    }

    // --- Colors ---
    function initColors() {
        const grid = document.getElementById('colors-grid-area');
        const src = document.getElementById('colors-source');
        grid.innerHTML = ''; src.innerHTML = '';

        colorsData.forEach(col => {
            let card = document.createElement('div');
            card.className = 'color-card';
            card.innerHTML = `<div class="color-display" style="background-color:${col.c};"></div><div class="color-slot" data-ans="${col.w}" ondrop="drop(event)" ondragover="allowDrop(event)"></div>`;
            grid.appendChild(card);
        });

        [...colorsData].sort(() => Math.random() - 0.5).forEach(col => createDraggable(col.w, src));
    }

    // --- Phonics ---
    function initPhonics() {
        const grid = document.getElementById('phonics-grid');
        const src = document.getElementById('phonics-source');
        grid.innerHTML = ''; src.innerHTML = '';
        
        phonicsData.forEach(l => {
             grid.innerHTML += `<div class="slot-inline" style="width:60px; height:60px;" data-ans="${l}" ondrop="drop(event)" ondragover="allowDrop(event)"></div>`;
        });

        let shuffled = [...phonicsData].sort(() => Math.random() - 0.5);
        shuffled.forEach(letter => {
            createDraggable(letter, src);
        });
    }

    // ============ DRAG & DROP CORE ============
    
    function createDraggable(text, container) {
        let d = document.createElement('div');
        d.className = 'draggable';
        d.draggable = true;
        d.innerText = text;
        d.id = 'drag-' + text.replace(/\s/g, '') + '-' + Math.random();
        
        d.ondragstart = (ev) => {
            ev.dataTransfer.setData("text", ev.target.id);
            speak(text);
        };
        d.onclick = () => speak(text);
        container.appendChild(d);
    }

    function allowDrop(ev) { ev.preventDefault(); }

    function drop(ev) {
        ev.preventDefault();
        let data = ev.dataTransfer.getData("text");
        let item = document.getElementById(data);
        let target = ev.target;

        if (!target.classList.contains('slot-inline') && !target.classList.contains('color-slot') && !target.classList.contains('pic-slot')) {
            target = target.closest('.slot-inline') || target.closest('.color-slot') || target.closest('.pic-slot');
        }

        if (target) {
            // Check if full (ignore icon)
            let isFull = Array.from(target.children).some(c => c.classList.contains('draggable'));
            if (isFull) return;

            // Instant Check
            if (item.innerText === target.dataset.ans) {
                if(target.querySelector('.puzzle-icon')) target.querySelector('.puzzle-icon').remove();
                target.appendChild(item);
                target.classList.add('correct');
                target.classList.remove('wrong');
                item.draggable = false;
                item.classList.add('locked');
                playSound(true);
                speak("Correct!");
            } else {
                playSound(false);
                target.classList.add('wrong');
                setTimeout(() => target.classList.remove('wrong'), 500);
            }
        }
    }

    function returnItem(ev) {
        ev.preventDefault();
        let data = ev.dataTransfer.getData("text");
        let item = document.getElementById(data);
        if (ev.target.classList.contains('source-box')) {
            ev.target.appendChild(item);
        }
    }

    // Start
    initIntro();

</script>

</body>
</html>